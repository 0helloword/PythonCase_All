*** Settings ***
Resource          ../元素操作/通用关键字.txt
Resource          ../元素操作/配置.txt

*** Test Cases ***
工单查询-工单编号
    读取excel数据-sa2
    获取数据库工单    35
    用户登录
    菜单选择    工单查询
    判断页面跳转    工单查询
    文本框输入    工单编号    ${app_id}
    按钮点击    查询
    按钮点击    查询
    判断结果页面包含链接    ${app_id}
    浏览器关闭
    [Teardown]    Close Browser

工单查询-商户名称
    读取excel数据-sa2
    用户登录
    菜单选择    工单查询
    判断页面跳转    工单查询
    文本框输入    商户名称    ${firmName}
    按钮点击    查询
    按钮点击    查询
    判断结果页面包含链接    ${app_id}    #商户名称未在列表显示，用工单号判断
    浏览器关闭
    [Teardown]    Close Browser

工单查询-门店名称
    读取excel数据-sa2
    用户登录
    菜单选择    工单查询
    判断页面跳转    工单查询
    文本框输入    门店名称    ${storeId}
    按钮点击    查询
    按钮点击    查询
    判断结果页面包含    ${storeId}
    浏览器关闭
    [Teardown]    Close Browser

工单查询-产品系列
    读取excel数据-sa2
    用户登录
    菜单选择    工单查询
    判断页面跳转    工单查询
    下拉选择    产品系列    ${productSeriesId}
    按钮点击    查询
    按钮点击    查询
    判断结果页面包含    ${productSeriesId}
    浏览器关闭
    [Teardown]    Close Browser

工单查询-申请人姓名
    读取excel数据-sa2
    用户登录
    菜单选择    工单查询
    判断页面跳转    工单查询
    文本框输入    申请人姓名    ${custname}
    按钮点击    查询
    按钮点击    查询
    判断结果页面包含    ${custname}
    浏览器关闭
    [Teardown]    Close Browser

工单查询-身份证号
    读取excel数据-sa2
    用户登录
    菜单选择    工单查询
    判断页面跳转    工单查询
    文本框输入    身份证号    ${idcard}
    按钮点击    查询
    按钮点击    查询
    判断结果页面包含链接    ${app_id}    #身份号未在列表显示，用工单号判断
    浏览器关闭
    [Teardown]    Close Browser

工单查询-销售顾问
    读取excel数据-sa2
    用户登录
    菜单选择    工单查询
    判断页面跳转    工单查询
    文本框输入    销售顾问    ${saName}
    按钮点击    查询
    按钮点击    查询
    判断结果页面包含    ${saName}
    浏览器关闭
    [Teardown]    Close Browser

工单查询-工单状态
    读取excel数据-sa2
    用户登录
    菜单选择    工单查询
    判断页面跳转    工单查询
    按钮点击    重置
    按钮点击    重置
    工单状态列表选择    待生成合同    #待生成合同
    验证记录条数    20
    工单状态列表选择    放款成功
    验证记录条数    50
    工单状态列表选择    工单撤销
    验证记录条数    70
    工单状态列表选择    拒绝
    验证记录条数    80
    工单状态列表选择    数据异常
    验证记录条数    90
    工单状态列表选择    待保理放款
    验证记录条数    35
    工单状态列表选择    待BUS放款
    验证记录条数    36
    工单状态列表选择    待签章
    验证记录条数    21
    工单状态列表选择    待上传资料
    验证记录条数    30
    工单状态列表选择    待交易确认
    验证记录条数    31
    工单状态列表选择    待放款
    验证记录条数    32
    工单状态列表选择    待额度审批
    验证记录条数    18
    工单状态列表选择    合同待审核
    Comment    验证记录条数    C1
    工单状态列表选择    合同审核退回
    Comment    验证记录条数    C2
    工单状态列表选择    合同审核通过
    Comment    验证记录条数    C3
    浏览器关闭
    [Teardown]    Close Browser

工单查询-贷款类型
    读取excel数据-sa2
    用户登录
    菜单选择    工单查询
    判断页面跳转    工单查询
    按钮点击    重置
    按钮点击    重置
    贷款类型列表选择    现金贷
    贷款类型列表选择    农机贷
    浏览器关闭
    [Teardown]    Close Browser

工单查询-工单申请时间
    读取excel数据-sa2
    用户登录
    菜单选择    工单查询
    判断页面跳转    工单查询
    获取当天日期
    选择时间    申请时间    ${today}
    按钮点击    查询
    按钮点击    查询
    判断结果页面包含链接    ${app_id}
    浏览器关闭
    [Teardown]    Close Browser

工单查询-工单详情
    读取excel数据-sa2
    用户登录
    菜单选择    工单查询
    判断页面跳转    工单查询
    文本框输入    工单编号    ${app_id}
    按钮点击    查询
    按钮点击    查询
    判断结果页面包含链接    ${app_id}
    点击链接    ${app_id}
    判断页面跳转    查看工单
    切换页面    上传资料
    切换页面    基础信息
    判断页面跳转    个人资料
    点击    返回
    判断页面跳转    工单查询
    浏览器关闭
    [Teardown]    Close Browser

工单查询-按键测试
    读取excel数据-sa2
    用户登录
    菜单选择    工单查询
    判断页面跳转    工单查询
    按钮点击    查询
    按钮点击    查询
    点击    下一页
    点击    最后一页
    输入页码    5
    点击    go
    点击    上一页
    点击    第一页
    浏览器关闭
    [Teardown]    Close Browser
